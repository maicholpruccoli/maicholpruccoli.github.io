"use strict";(self.webpackChunkwelcome_sbm=self.webpackChunkwelcome_sbm||[]).push([[462],{55462:(B,p,i)=>{i.r(p),i.d(p,{MySelfModule:()=>c});var h=i(96814),v=i(30395),M=i(30087),b=i(56208),g=i(52329),x=i(38033),L=i(2445),S=i(86107),w=i(14090),e=i(65879),A=i(47292),_=i(19209),P=i(85105),Z=i(2353),I=i(30724),k=i(45754),T=i(94505),J=i(84187),N=i(42400),f=i(56223),z=i(89515);function G(a,n){if(1&a){const o=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",3)(2,"input",4),e.NdJ("ngModelChange",function(t){e.CHM(o);const l=e.oxw();return e.KtG(l.emailCodice=t)})("keyup.enter",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.login())}),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"mat-form-field",3)(5,"input",5),e.NdJ("ngModelChange",function(t){e.CHM(o);const l=e.oxw();return e.KtG(l.passwordCognome=t)})("keyup.enter",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.login())}),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"mat-checkbox",6),e.NdJ("ngModelChange",function(t){e.CHM(o);const l=e.oxw();return e.KtG(l.accessoConCodice=t)})("change",function(){e.CHM(o);const t=e.oxw();return t.emailCodice="",e.KtG(t.passwordCognome="")}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.login())}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.recuperoPassword=!0)}),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.BQk()}if(2&a){const o=e.oxw();e.xp6(2),e.Q6J("placeholder",e.lcZ(3,9,o.accessoConCodice?"myself.login.codicePrenotazione":"myself.login.email"))("ngModel",o.emailCodice),e.xp6(3),e.Q6J("type",o.accessoConCodice?"text":"password")("placeholder",e.lcZ(6,11,o.accessoConCodice?"myself.login.cognome":"myself.login.password"))("ngModel",o.passwordCognome),e.xp6(2),e.Q6J("ngModel",o.accessoConCodice),e.xp6(1),e.hij(" ",e.lcZ(9,13,"myself.login.accessoConCodice")," "),e.xp6(3),e.Oqu(e.lcZ(12,15,"myself.login.login")),e.xp6(3),e.Oqu(e.lcZ(15,17,"myself.login.passwordDimenticata"))}}function H(a,n){if(1&a){const o=e.EpF();e.ynx(0),e.TgZ(1,"h4",8),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"input",9,10),e.NdJ("keyup.enter",function(){e.CHM(o);const t=e.MAs(6),l=e.oxw();return e.KtG(l.recuperaPassword(t.value))}),e.ALo(7,"translate"),e.qZA()(),e.TgZ(8,"button",11),e.NdJ("click",function(){e.CHM(o);const t=e.MAs(6),l=e.oxw();return e.KtG(l.recuperaPassword(t.value))}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.recuperoPassword=!1)}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.BQk()}if(2&a){const o=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,5,"myself.recuperaPassword")),e.xp6(3),e.Q6J("placeholder",e.lcZ(7,7,"myself.login.email"))("value",o.emailCodice?o.emailCodice:""),e.xp6(4),e.Oqu(e.lcZ(10,9,"globals.conferma")),e.xp6(3),e.Oqu(e.lcZ(13,11,"globals.annulla"))}}class d extends w.H{constructor(n,o,s,t,l,u){super(),this._authService=n,this.route=o,this.router=s,this.apiService=t,this.localizationService=l,this.utility=u,this.recuperoPassword=!1,this.accessoConCodice=!0,this.isLoginInCorso=!1}ngOnInit(){this.sub=this.route.queryParamMap.subscribe(n=>{let o=n.get("oidAlbergo"),s=n.get("oidPortale"),t=n.get("lingua"),l=n.get("email"),u=n.get("codicePrenotazione"),C=n.get("password"),y=n.get("cognome");l||C?(this.accessoConCodice=!1,this.emailCodice=l,this.passwordCognome=C):(u||y)&&(this.accessoConCodice=!0,this.emailCodice=u,this.passwordCognome=y),t&&null!=this.localizationService.languages.find(Y=>Y.codice==t)&&this.localizationService.setDefaultLang(t),o&&!isNaN(+o)||s&&!isNaN(+s)?(this.setIsLoading(!0),s&&!isNaN(+s)?this.apiService.checkPortale(+s).subscribe(m=>{m.data.success&&m.data.oidAlbergo>0?(this.oidPortale=+s,this.oidAlbergo=m.data.oidAlbergo,this.emailCodice&&this.passwordCognome?this.login():this.setIsLoading(!1)):this.router.navigate(["sbm"]).then(()=>{this.setIsLoading(!1)})}):this.apiService.checkAlbergo(+o).subscribe(m=>{m.data.success?(this.oidAlbergo=+o,this.emailCodice&&this.passwordCognome?this.login():this.setIsLoading(!1)):this.router.navigate(["sbm"]).then(()=>{this.setIsLoading(!1)})})):this.router.navigate(["sbm"])}),this.backgroundImage=this.utility.getRandomImage()}login(){if(!this.isLoginInCorso)if(this.emailCodice&&this.passwordCognome){let n=null,o=null,s=null,t=null;this.accessoConCodice?(o=this.emailCodice,t=this.passwordCognome):(n=this.emailCodice,s=this.passwordCognome),this.setIsLoading(!0),this.isLoginInCorso=!0,this._authService.loginMySelf(!0,this.oidAlbergo,this.oidPortale,n,s,t,o).then(l=>{this.isLoginInCorso=!1,null!=l&&null!=l.portaleXAlbergo&&(this.oidPortale=l.portaleXAlbergo.oid),null!=this.oidPortale?this.router.navigate(["self-checkin/home"],{queryParams:{oidPortale:this.oidPortale}}).then(()=>this.setIsLoading(!1)):this.router.navigate(["self-checkin/home"]).then(()=>this.setIsLoading(!1))},()=>{this.isLoginInCorso=!1})}else this.showError("globals.messages.inserireDati")}recuperaPassword(n){if(n){this.setIsLoading(!0);let o=new S.QPQ;o.email=n,o.oidAlbergo=this.oidAlbergo,this.apiService.recuperaPassword(o).subscribe(s=>{this.setIsLoading(!1),s.data.success?this.showInfo("myself.emailInviata").then(()=>{this.recuperoPassword=!1}):this.showError("myself.erroreRecuperoPassword").then(()=>{this.recuperoPassword=!1})})}else this.showError("globals.messages.inserireDati")}ngOnDestroy(){this.sub.unsubscribe()}}d.\u0275fac=function(n){return new(n||d)(e.Y36(A.$),e.Y36(g.gz),e.Y36(g.F0),e.Y36(_.s),e.Y36(P.o),e.Y36(Z.t))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-my-self-login"]],features:[e.qOj],decls:4,vars:4,consts:[["id","login-myself",1,"container-fluid","w-100","h-100","pr-3","pl-3","position-absolute"],[1,"mx-auto","border","mat-elevation-z10","container-fluid","p-3","login-container"],[4,"ngIf"],[1,"w-100"],["autocompleteOff","","matInput","","required","",3,"placeholder","ngModel","ngModelChange","keyup.enter"],["autocompleteOff","","matInput","","required","",3,"type","placeholder","ngModel","ngModelChange","keyup.enter"],[3,"ngModel","ngModelChange","change"],["mat-flat-button","",1,"w-100","mt-1","button-blue",3,"click"],[1,"mb-4","text-center"],["autocompleteOff","","matInput","","required","",3,"placeholder","value","keyup.enter"],["emailRecupero",""],["mat-flat-button","",1,"mr-1","w-100","mt-2","button-blue",3,"click"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,G,16,19,"ng-container",2),e.YNc(3,H,14,13,"ng-container",2),e.qZA()()),2&n&&(e.Udp("background-image",o.backgroundImage),e.xp6(2),e.Q6J("ngIf",!o.recuperoPassword),e.xp6(1),e.Q6J("ngIf",o.recuperoPassword))},dependencies:[h.O5,I.X,k.FC,T.eB,J.v_,N.k0,f.Fj,f.JJ,f.Q7,f.On,z.X$],styles:[".login-container[_ngcontent-%COMP%]{margin-top:150px;background-color:#fff;border-radius:5px;width:400px;max-width:100%}  #login-myself{background-position:center;background-repeat:no-repeat;background-size:cover}  #login-myself .mat-form-field .mat-form-field-label{color:#0000008a!important}  #login-myself .mat-form-field.mat-form-field-invalid .mat-form-field-label{color:#0000008a!important}  #login-myself .mat-form-field.mat-form-field-should-float .mat-form-field-label{color:#004987!important}  #login-myself .mat-form-field .mat-form-field-ripple{background-color:#000000de!important}  #login-myself .mat-form-field.mat-form-field-invalid .mat-form-field-ripple{background-color:#000000de!important}  #login-myself .mat-form-field.mat-focused .mat-form-field-ripple{background-color:#004987!important}  #login-myself .mat-form-field.mat-focused.mat-primary .mat-select-arrow{color:#004987!important}  #login-myself .mat-form-field .mat-select.mat-select-invalid .mat-select-arrow{color:#004987!important}  #login-myself .mat-form-field.mat-form-field-invalid .mat-input-element{caret-color:#004987!important}  #login-myself .mat-form-field.mat-form-field-invalid .mat-form-field-label .mat-form-field-required-marker{color:#004987!important}  #login-myself .mat-input-element{caret-color:#004987!important}  #login-myself .mat-datepicker-toggle{color:#004987!important}  #login-myself .mat-checkbox-checked .mat-checkbox-background{background-color:#004987!important}"]});const O=[{path:"",component:d},{path:"home",component:L.l,canActivate:[x.p]}];class r{}r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[g.Bz.forChild(O),g.Bz]});var Q=i(39402),F=i(10244),K=i(2214);class c{constructor(n,o,s){this.headerService=n,this.cssLoaderService=o,this.sessionService=s,this.headerService.hideHeader(),this.cssLoaderService.unloadCssDms(),this.sessionService.isAttachRequestHeaders=!1}}c.\u0275fac=function(n){return new(n||c)(e.LFG(Q.r),e.LFG(F.e),e.LFG(K.m))},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[h.ez,b.m,v.Q,M.E,r]})}}]);